#: import main secretstore
#: import ListAdapter kivy.adapters.listadapter.ListAdapter
#: import ListItemButton kivy.uix.listview.ListItemButton

SecretStore:

<SecretListButton>:
    selected_color: 0x26 / 255, 0x32 / 255, 0x38 / 255, 150 /255
    deselected_color: 0x26 / 255, 0x32 / 255, 0x38 / 255, 100 /255

<SecretStore>:

    secret_list: secret_list_view
    secret_key_ti: secret_key
    secret_value_ti: secret_value

    vault_ti: vault
    tenant_ti: tenant

    tabbed_view: tabbed_panel_view
    tab_sync: tab_sync_view
    tab_add: tab_add_view

    orientation: "vertical"
    padding: 10
    spacing: 10

    canvas.before:
        Color:
            rgb: 0x26 / 255.0, 0x32 / 255, 0x38 / 255.0
        Rectangle:
            size: self.size
            pos: self.pos

    BoxLayout:
        size_hint_y: .1

        Label:
            text: "Hush"

    BoxLayout:
        padding: 10
        spacing: 10

        TabbedPanel:
            do_default_tab: False
            tab_pos: "top_mid"
            id: tabbed_panel_view

            TabbedPanelItem:
                text: "sync"
                on_press: root.refresh_secrets()
                id: tab_sync_view

                BoxLayout:
                    orientation: "vertical"

                    canvas:
                        Color:
                            rgb: 0x68 /255, 0x82/ 255, 0x9e / 255
                        Rectangle:
                            size: self.size
                            pos: self.pos

                    BoxLayout:
                        padding: 10
                        size_hint_y: .9

                        ListView:
                            id: secret_list_view
                            scrolling: True
                            adapter:
                                ListAdapter(data=[], cls=main.SecretListButton, selection_mode="single", args_converter=lambda row_index, obj: {'text': obj, 'size_hint_y': .15})

                    BoxLayout:
                        padding: 10
                        size_hint_y: .1

                        BoxLayout:
                            size_hint_x: .4

                        BoxLayout:
                            orientation: "horizontal"
                            size_hint_x: .6


                            Button:
                                text: "Edit"
                                size_hint_x: 15
                                on_press: root.update_secret()
                            Button:
                                text: "Get"
                                size_hint_x: 15
                                on_press: root.get_secret()

            TabbedPanelItem:
                text: "add"
                id: tab_add_view

                BoxLayout:
                    orientation: "vertical"

                    canvas:
                        Color:
                            rgb: 0x68 /255, 0x82/ 255, 0x9e / 255
                        Rectangle:
                            size: self.size
                            pos: self.pos

                    BoxLayout:
                        orientation: "horizontal"
                        padding: 10
                        size_hint_y: .9

                        BoxLayout:
                            orientation: "vertical"
                            size_hint_x: .3

                            Label:
                                text: "Unique Name"
                            Label:
                                text: "Secret"

                        BoxLayout:
                            orientation: "vertical"

                            TextInput:
                                id: secret_key
                                multiline: False
                                background_color: 1,1,1,220/255
                            TextInput:
                                id: secret_value
                                password: True
                                password_mask: "*"
                                multiline: False
                                background_color: 1,1,1,220/255

                    BoxLayout:
                        padding: 10
                        size_hint_y: .1

                        BoxLayout:
                            size_hint_x: .4

                        BoxLayout:
                            orientation: "horizontal"
                            size_hint_x: .6


                            Button:
                                text: "Delete"
                                size_hint_x: 15
                                on_press: root.delete_secret()
                            Button:
                                text: "Save"
                                size_hint_x: 15
                                on_press: root.set_secret()

            TabbedPanelItem:
                text: "config"
                on_press: root.refresh_configuration()

                BoxLayout:
                    orientation: "vertical"

                    canvas:
                        Color:
                            rgb: 0x68 /255, 0x82/ 255, 0x9e / 255
                        Rectangle:
                            size: self.size
                            pos: self.pos

                    BoxLayout:
                        orientation: "horizontal"
                        padding: 10
                        size_hint_y: .9

                        BoxLayout:
                            orientation: "vertical"
                            size_hint_x: .3

                            Label:
                                text: "KeyVault Name"
                            Label:
                                text: "Tenant Id"

                        BoxLayout:
                            orientation: "vertical"

                            TextInput:
                                id: vault
                                multiline: False
                                background_color: 1,1,1,220/255
                            TextInput:
                                id: tenant
                                multiline: False
                                background_color: 1,1,1,220/255

                    BoxLayout:
                        padding: 10
                        size_hint_y: .1

                        BoxLayout:
                            size_hint_x: .7

                        BoxLayout:
                            orientation: "horizontal"
                            size_hint_x: .3

                            Button:
                                text: "Save"
                                size_hint_x: 15
                                on_press: root.set_configuration()
